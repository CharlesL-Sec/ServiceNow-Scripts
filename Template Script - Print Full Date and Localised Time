/**
 * Description: Returns the full formatted date to the calling template. e.g. 12th March 2026 11:58 AM Europe/London
 * Application: Security Incident Response
 * Trigger: Called using ${Template_script: fotmatted_current_date from Report Template
 * Developed By: Charles L / Digital Safety ServiceNow Development Team
 * Date: 19th February 2026
 * Update Set: [Name]
 * Location: All > Major Security Incident Management > MSI Administration > Status Report Setup > Template Scripts 
**/

### Name: formatted_current_date


### Description: Returns the current local date and time in the DDMMYYYY 00.00 AM or PM format. For example, 21 Jan 2021 3:51 PM PST

```javascript
(function runTemplateScript(target /*GlideRecord for target task*/ ) {
    // 1. Get the date field from the MSI record. 
    // Common MSI fields: 'opened_at', 'work_start', or 'sys_created_on'
    var msiDate = target.opened_at; 

    // 2. Safety check: if the field is empty, return a fallback message
    if (!msiDate || msiDate.nil()) {
        return "Date TBC";
    }

    // 3. Initialize GlideDateTime using the record's date
    var gdt = new GlideDateTime(msiDate);
    
    var currentDate = gdt.getLocalDate(); 
    var currentTime = gdt.getLocalTime();
    
    // 4. Return the formatted string using your preferred format
    return [
        currentDate.getByFormat("EEEE dd MMMM yyyy") + "<br/>" + 
        currentTime.getByFormat("K:mm a") + " " + 
        gs.getSession().getTimeZoneName()
    ].join(" ");

})(target);
```
